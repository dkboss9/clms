<!-- Vendor -->

<script src="<?php echo base_url("");?>assets/vendor/jquery-browser-mobile/jquery.browser.mobile.js"></script>
<script src="<?php echo base_url("");?>assets/vendor/bootstrap/js/bootstrap.js"></script>
<script src="<?php echo base_url("");?>assets/vendor/nanoscroller/nanoscroller.js"></script>
<script src="<?php echo base_url("");?>assets/vendor/bootstrap-datepicker/js/bootstrap-datepicker.js"></script>
<script src="<?php echo base_url("");?>assets/vendor/bootstrap-colorpicker/js/bootstrap-colorpicker.js"></script>
<script src="<?php echo base_url("");?>assets/vendor/bootstrap-timepicker/js/bootstrap-timepicker.js"></script>
<script src="<?php echo base_url("");?>assets/vendor/magnific-popup/magnific-popup.js"></script>
<script src="<?php echo base_url("");?>assets/vendor/jquery-placeholder/jquery.placeholder.js"></script>

<!-- Specific Page Vendor -->
<script src="<?php echo base_url("");?>assets/vendor/jquery-ui/js/jquery-ui-1.10.4.custom.js"></script>
<script src="<?php echo base_url("");?>assets/vendor/jquery-ui-touch-punch/jquery.ui.touch-punch.js"></script>
<script src="<?php echo base_url("");?>assets/vendor/jquery-appear/jquery.appear.js"></script>
<script src="<?php echo base_url("");?>assets/vendor/bootstrap-multiselect/bootstrap-multiselect.js"></script>
<script src="<?php echo base_url("");?>assets/vendor/jquery-easypiechart/jquery.easypiechart.js"></script>
<script src="<?php echo base_url("");?>assets/vendor/flot/jquery.flot.js"></script>
<script src="<?php echo base_url("");?>assets/vendor/flot-tooltip/jquery.flot.tooltip.js"></script>
<script src="<?php echo base_url("");?>assets/vendor/flot/jquery.flot.pie.js"></script>
<script src="<?php echo base_url("");?>assets/vendor/flot/jquery.flot.categories.js"></script>
<script src="<?php echo base_url("");?>assets/vendor/flot/jquery.flot.resize.js"></script>
<script src="<?php echo base_url("");?>assets/vendor/jquery-sparkline/jquery.sparkline.js"></script>
<script src="<?php echo base_url("");?>assets/vendor/raphael/raphael.js"></script>
<script src="<?php echo base_url("");?>assets/vendor/morris/morris.js"></script>
<script src="<?php echo base_url("");?>assets/vendor/gauge/gauge.js"></script>
<script src="<?php echo base_url("");?>assets/vendor/snap-svg/snap.svg.js"></script>
<script src="<?php echo base_url("");?>assets/vendor/liquid-meter/liquid.meter.js"></script>
<script src="<?php echo base_url("");?>assets/vendor/jqvmap/jquery.vmap.js"></script>
<script src="<?php echo base_url("");?>assets/vendor/jqvmap/data/jquery.vmap.sampledata.js"></script>
<script src="<?php echo base_url("");?>assets/vendor/jqvmap/maps/jquery.vmap.world.js"></script>
<script src="<?php echo base_url("");?>assets/vendor/jqvmap/maps/continents/jquery.vmap.africa.js"></script>
<script src="<?php echo base_url("");?>assets/vendor/jqvmap/maps/continents/jquery.vmap.asia.js"></script>
<script src="<?php echo base_url("");?>assets/vendor/jqvmap/maps/continents/jquery.vmap.australia.js"></script>
<script src="<?php echo base_url("");?>assets/vendor/jqvmap/maps/continents/jquery.vmap.europe.js"></script>
<script src="<?php echo base_url("");?>assets/vendor/jqvmap/maps/continents/jquery.vmap.north-america.js"></script>
<script src="<?php echo base_url("");?>assets/vendor/jqvmap/maps/continents/jquery.vmap.south-america.js"></script>
<script src="<?php echo base_url("");?>assets/vendor/jquery-autosize/jquery.autosize.js"></script>
<script src="<?php echo base_url("");?>assets/vendor/bootstrap-fileupload/bootstrap-fileupload.min.js"></script>
<script src="<?php echo base_url("");?>assets/vendor/bootstrap-markdown/js/markdown.js"></script>
<script src="<?php echo base_url("");?>assets/vendor/bootstrap-markdown/js/to-markdown.js"></script>
<script src="<?php echo base_url("");?>assets/vendor/bootstrap-markdown/js/bootstrap-markdown.js"></script>
<script src="<?php echo base_url("");?>assets/vendor/jquery-validation/jquery.validate.js"></script>

<script src="<?php echo base_url("");?>assets/vendor/bootstrap-wizard/jquery.bootstrap.wizard.js"></script>
<script src="<?php echo base_url("");?>assets/vendor/pnotify/pnotify.custom.js"></script>

<script src="<?php echo base_url("");?>assets/vendor/fullcalendar/lib/moment.min.js"></script>
<script src="<?php echo base_url("");?>assets/vendor/fullcalendar/fullcalendar.js"></script>
<script type="text/javascript" src="<?php echo base_url()?>chat/js/chat.js"></script>
<!-- Theme Base, Components and Settings -->

<script src="<?php echo base_url("");?>assets/javascripts/theme.js"></script>
<script src="<?php echo base_url("");?>themes/ckeditor/ckeditor.js"></script>

<!-- Theme Custom -->
<script src="<?php echo base_url("");?>assets/javascripts/theme.custom.js"></script>

<!-- Theme Initialization Files -->
<script src="<?php echo base_url("");?>assets/javascripts/theme.init.js"></script>


<!-- Examples -->
<?php if($this->uri->segment(1) == "dashboard"){?>
<script src="<?php echo base_url("");?>assets/javascripts/welcome/examples.dashboard.js"></script>
<?php } ?>
<script src="<?php echo base_url("");?>assets/vendor/select2/select2.js"></script>
<script src="<?php echo base_url("");?>assets/vendor/jquery-datatables/media/js/jquery.dataTables.js"></script>
<script src="<?php echo base_url("");?>assets/vendor/jquery-datatables/extras/TableTools/js/dataTables.tableTools.min.js"></script>
<script src="<?php echo base_url("");?>assets/vendor/jquery-datatables-bs3/assets/js/datatables.js"></script>

<!-- Theme Base, Components and Settings -->
<script src="<?php echo base_url("");?>assets/javascripts/theme.js"></script>

<!-- Theme Custom -->
<script src="<?php echo base_url("");?>assets/javascripts/theme.custom.js"></script>

<!-- Theme Initialization Files -->
<script src="<?php echo base_url("");?>assets/javascripts/theme.init.js"></script>

<!-- Examples -->
<script src="<?php echo base_url("");?>assets/javascripts/tables/examples.datatables.default.js"></script>
<script src="<?php echo base_url("");?>assets/javascripts/tables/examples.datatables.row.with.details.js"></script>
<script src="<?php echo base_url("");?>assets/javascripts/tables/examples.datatables.tabletools.js"></script>
<script src="<?php echo base_url("");?>assets/javascripts/forms/examples.validation.js"></script>
<script src="<?php echo base_url("");?>assets/javascripts/forms/examples.advanced.form.js"></script>
<script src="<?php echo base_url("");?>assets/javascripts/ui-elements/examples.lightbox.js"></script>
<script src="<?php echo base_url("");?>assets/javascripts/pages/examples.calendar.js"></script>
<script src="<?php echo base_url("");?>assets/javascripts/jquery.colorbox.js"></script>
<script src="<?php echo base_url("");?>admin/themes/js/main.js"></script>
<script src="<?php echo base_url("");?>assets/javascripts/forms/examples.wizard.js"></script>

<?php
$events = $this->welcomemodel->get_todayEvents(strtotime(date("m/d/Y")),'0');
$string = "";
//echo $this->db->last_query();
//date_default_timezone_set("Asia/Kathmandu"); 
date_default_timezone_set("Australia/Sydney"); 
//echo date("Y-m-d h:i:s");
foreach ($events as $event) {
	$starttime = strtotime($event->event_time);
	$currenttime = time();
	$diff = ($starttime - $currenttime)/3600;
	if($diff > 0 && $diff < $event->reminder_time){
		$string.='<p>'.$event->event_name.'</p>';
		$string.='<p>'.$event->event_details.'</p>';
		$string.='<p> At'.$event->event_time.'</p>';
		$string.='<hr>';

		$this->db->where("event_id",$event->event_id);
		$this->db->set("is_reminded",1);
		$this->db->update("events");
	}

}
//echo $string;
if($string !=""){
	?>
	<script type="text/javascript">
		$(document).ready(function(){
			$.colorbox({inline:true, href:"#event_reminder",escKey: false});
		});
	</script>
	<?php
}
?>

<script type="text/javascript">
	$(document).ready(function(){
		$(".sidebar-toggle").trigger("click");
			//$.colorbox({inline:true, href:"#event_reminder",escKey: false,overlayClose: false});
			$.ajax({
				type	: "POST",
				url		: "<?php echo base_url();?>index.php/welcome/getuser",
				data	: "action=getuser",
				success	: function(msg){
					$("#userdetails").html(msg);	
				}
			});
			$(".sidebar-right-toggle").click(function(){
				if(!confirm("Are you sure to logout?"))
					return false;
			})
		});
	function edituser(){
		var phone = $("#profile_phone").val();
		var fname = $("#profile_firstname").val();
		var lname = $("#profile_lastname").val();	
		var email = $("#profile_email").val();
		var pass  = $("#profile_password").val();
		var passcode = $("#profile_passcode").val();
		var consumer_key = $("#consumer_key").val();
		var consumer_secret = $("#consumer_secret").val();
		var access_token = $("#access_token").val();
		var access_secret = $("#access_secret").val();
		var picture = $("#images_picture").val();
		$.ajax({
			type: "POST",
			url: "<?php echo base_url();?>index.php/welcome/getuser",
			data: "fname="+fname+"&lname="+lname+"&password="+pass+"&passcode="+passcode+"&consumer_key="+consumer_key+"&consumer_secret="+consumer_secret+"&access_token="+access_token+"&access_secret="+access_secret+"&phone="+phone+"&email="+email+"&picture="+picture+"&action=update",
			success: function (msg) {
				if(msg=='yes'){
					$(".success-message").show();
					$(".success-message").html('Profile edited successfully');
					$(".success-message").delay(5000).slideUp('slow',function(){
						$(".success-message").html('');
					});
				}else{
					$(".error-message").show();
					$(".error-message").html(msg);
					$(".error-message").delay(5000).slideUp('slow',function(){
						$(".error-message").html('');
					});

				}
			}
		});
	}	
</script>

<form name="edituser" id="edituserform" class="white-popup-block mfp-hide form-horizontal" action="javascript:edituser();">
	<div class="row">
		<div class="col-sm-12">
			<h3>My Profile</h3>
		</div>
	</div>
	
	<div class="error-message" id="error-message"></div>
	<div class="success-message" id="success-message"></div>

	<div id="userdetails"></div>

	
</form>
<!-- /.modal-content --> 

<div style="display:none;">
	<div id="event_reminder">

		<form id="demo-form" method="post" class="white-popup-block  form-horizontal" action="<?php echo base_url("events/add");?>">
			<div class="row">
				<div class="col-sm-12">
					<h3>Add Event</h3>
				</div>
			</div>
			<?php echo $string;?>


		</form>

	</div>
</div>
<script type="text/javascript">
	function confirmation(heading, question, cancelButtonTxt, okButtonTxt, callback,action='',cascadelink='') {

		var confirmModal = 
		$('<div class="modal" >' +        
			'<div class="modal-dialog" >' +
			'<div class="modal-content ch_mcont" >' +
			'<div class="modal-header ch_mheader">' +
			'<a class="close" data-dismiss="modal" >&times;</a>' +
			'<h3><span class="modal-icon" style="width:10%;float:none;"><i class="fa fa-question-circle"></i></span><strong>' + heading +'</strong></h3>' +
			'</div>' +

			'<div class="modal-body ch_mbody" style="height:200px;">' +
			'<p>' + question + '</p>' +
			'</div>' +

			'<div class="modal-footer ch_mfooter">' +
			'<a href="#!" class="btn btn-primary" data-dismiss="modal">' + 
			cancelButtonTxt + 
			'</a>' +
			'<a href="#!" id="okButton" class="btn btn-danger">' + 
			okButtonTxt + 
			'</a>' +
			'</div>' +
			'</div>' +
			'</div>' +
			'</div>');

		confirmModal.find('#okButton').click(function(event) {
			if(callback != ""){
				window.location.href = callback;
			}else{
				var ids = checkedCheckboxId();
				if(ids.length == 0){
					confirmModal.modal('hide');
					alert("Select atleast one data to proceed this action");
					return false;
				}
				var jsonData ={"object":{"ids":ids,"action":action}};
				$.ajax({
					url:cascadelink,
					type:"post",
					data:jsonData,
					success: function(msg){
						location.reload();
					}
				});
				confirmModal.modal('hide');
			}
			
		}); 
		confirmModal.modal('show');    
	};  

</script>
</body>
</html>